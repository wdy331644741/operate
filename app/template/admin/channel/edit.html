{include file="header.html"}
<style type="text/css">
    h2{ text-align: center;}
</style>
<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
     <div class="top-title">
            <h2 class="sub-header">修改渠道信息</h2>
            <div class="top-tools">
              <a class="btn btn-default" href="?c=channels&a=index">返回</a>
            </div>
          </div>
    <div id="myTabContent" class="tab-content" style="margin-top:10px">

        <!-- start 线下合同 -->
        <div class="tab-pane fade in active" id="no2">

            <form class="form-horizontal"   method="post" >
                <h2>用户渠道信息</h2>
                <!--红包的基本信息-->
                <div class="form-group">
                    <label class="col-sm-2 control-label">渠道标识：</label>
                    <div class="col-sm-7">
                        <input type="text" name="code" value="{$list['code']}" class="form-control" placeholder="渠道标识">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">渠道名称：</label>
                    <div class="col-sm-7">
                        <input type="text" name="name" value="{$list['name']}" class="form-control" placeholder="渠道名称">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">渠道描述：</label>
                    <div class="col-sm-7">
                        <input type="text" name="description" value="{$list['description']}" class="form-control" placeholder="渠道描述">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">计价方式：</label>
                    <div class="col-sm-7">
                        <input type="text" name="classification" value="{$list['classification']}" class="form-control" placeholder="计价方式">
                    </div>
                </div>
                <!-- <div class="form-group">
                     <label for="effective_end" class="col-sm-2 control-label">添加图片：</label>
                     <div class="col-sm-7">
                         <input type="file" name="image" id="effective_start" value="" class="form-control">
                     </div>
                 </div>-->
                <div class="form-group">
                    <label for="platform" class="col-sm-2 control-label">活动平台：</label>
                    <div class="col-sm-7">
                        <input type="text" name="platform" id="platform" value="{$list['platform']}" class="form-control">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">合作状态：</label>
                    <div class="col-sm-7">
                        <input type="text" name="coop_status" value="{$list['coop_status']}" class="form-control" placeholder="合作状态">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">开始时间：</label>
                    <div class="col-sm-7">
                        <input type="text" name="start_at" value="{$list['start_at']}" id="start_at" class="form-control" placeholder="开始时间">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">结束时间：</label>
                    <div class="col-sm-7">
                        <input type="text" name="end_at" value="{$list['end_at']}" id="end_at" class="form-control" placeholder="结束时间">
                    </div>
                </div>
                <div class="form-group">
                    <label  for="is_abandoned" class="col-sm-2 control-label">是否弃用：</label>
                    <div class="col-sm-7">
                        <div class="input-group">
                            <select class="form-control" name="is_abandoned" id="is_abandoned">
                                <option {if $list['is_abandoned'] ==1}selected{/if}  value="1">已使用</option>
                                <option {if $list['is_abandoned'] ==0}selected{/if} value="0">未使用</option>
                            </select>
                        </div>
                    </div>
                </div>
                <!--用户的基本信息 end-->
                <div class="form-group">
                    <div class="col-sm-7">
                        <input type="hidden" name="id" value="{$list.id}">
                        <button type="button" class="btn btn-primary edit_channel pull-right" >提交</button>
                    </div>
                </div>


            </form>

        </div>
        <!-- end 线下合同 -->
    </div>
    <hr/>
</div>

<script>
    $('#start_at').datetimepicker();
    $('#end_at').datetimepicker();
</script>
<script>

    $(".edit_channel").click(function(){
        var id = $('input[name=id]').val();
        var code = $('input[name=code]').val();
        var name = $('input[name=name]').val();
        var description = $('input[name=description]').val();
        var classification=$('input[name=classification]').val();
        //var image=$('input[name=image]').val();
        var platform=$('input[name=platform]').val();
        var coop_status=$('input[name=coop_status]').val();
        var start_at=$('input[name=start_at]').val();
        var end_at=$('input[name=end_at]').val();
        var is_abandoned=$('select[name=is_abandoned]').val();
        if(code == '')
        {
            throwExc('渠道码必须填写');
            return false;
        }
        if(name == '')
        {
            throwExc('渠道名必须填写');
            return false;
        }
        if($.trim(start_at) == '')
        {
            throwExc('有效期开始时间必须填写');
            return false;
        }
        if($.trim(end_at)==''){
            throwExc('有效期结束时间必须填写');
            return false;
        }
        if(end_at < start_at )
        {
            throwExc('有效期开始时间必须大于有效期结束时间');
            return false;
        }
        $.post("?c=channels&a=edit",{
            'id':id,
            'code':code,
            'name':name,
            'description':description,
            'classification':classification,
            'platform':platform,
            'coop_status':coop_status,
            'start_at':start_at,
            'end_at':end_at,
            'is_abandoned':is_abandoned,
        },function( response ){
            console.log(response);
            if(response.error==100) {
                throwExc(response.msg);
                return false;
            }else if(response.error==200) {
                showSucc(response.msg);
                setTimeout("load()",1000);
            }
        },"json");
    });

    function load(){
        window.location.href="?c=channels&a=index";
    }
</script>
{include file="footer.html"}