{include file="header.html"}
<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
    <div class="top-title">
        <h2 class="sub-header">人工提现列表&nbsp;&nbsp;<small>共{if isset($total)}{$total}{/if}条数据</small></h2>
        <div class="top-tools">
        </div>
    </div>
    <div style="clear:both"></div>
    <form name="form1" class="form-inline" method="post" action="?c=withdraw&a=lst">
        <div class="form-group">
            <div class="form-group">
                开始时间:<input type="text" class="form-control" value="{if $startTime}{$startTime}{/if}" name="start_time" id="datepicker">
            </div>
            <div class="form-group">
                结束时间:<input type="text" class="form-control" value="{if $endTime}{$endTime}{/if}" name="end_time" id="datepicker1">
            </div>
            <div class="form-group">
                手机号码:<input type="text" class="form-control" value="{if $phone}{$phone}{/if}" name="phone" id="phone">
            </div>
            <input type="hidden"  value="{$pageCurrentNum}" name="pageCurrentNum" id="pageCurrentNum">
            <button type="submit" class="btn btn-default" onClick="form1.submit();">查询</button>
        </div>
    </form>
    <script>
        $("#datepicker").datetimepicker({ language:'zh-CN',format: 'yyyy-mm-dd hh:ii:ss'});
        $("#datepicker1").datetimepicker({ language:'zh-CN',format: 'yyyy-mm-dd hh:ii:ss'});
    </script>
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
            <tr>
                <th >编号</th>
                <th >订单号</th>
                <th >用户手机号</th>
                <th >金额</th>
                <th >申请时间</th>
                <th >提现银行</th>
                <th >状态</th>
                <th >操作</th>
            </tr>
            </thead>
            <tbody>
            {if $lists}
            {foreach $lists as $item}
            <tr>
                <td>{$item.id}</td>
                <td>{$item.order_id}</td>
                <td>{$item.phone}</td>
                <td>{$item.amount}</td>
                <td>{$item.create_time}</td>
                <td>{$item.bank_name}</td>
                <td>{if $item.real_status==100}处理中{else if $item.real_status==110}审核完成{else if $item.real_status==200}成功{else}失败{/if}</td>
                <td>
                    {if $item.real_status==100}
                    <button type="button" data-value="{$item.id}" class="btn btn-primary btn-sm withdraw_pass">审核通过</button>
                    <button type="button" data-value="{$item.id}" class="btn btn-danger btn-sm audit_fail">审核拒绝</button>
                    {else}
                    {/if}
                </td>
            </tr>
            {/foreach}
            {/if}
            </tbody>
        </table>
    </div>
    <div>{if isset($pageNum)}{$pageNum}{/if}</div>
    {include file="footer.html"}
  <script>
      $(".withdraw_pass").click(function() {
          var id = $(this).attr("data-value");
          $.ajax({
              url: "?c=withdraw&a=verifyWithdraw",
              type: 'POST',
              data: "id="+id,
              dataType:'json',
              success: function (response) {
                  if (response.error == 200) {
                      showSucc(response.msg);
                      setTimeout("load()", 1000);
                  } else {
                      throwExc(response.msg);
                      return false;
                  }
              }
          });
      });
      $(".audit_fail").click(function() {
          var id = $(this).attr("data-value");
          $.ajax({
              url: "?c=withdraw&a=auditRefuse",
              type: 'POST',
              data: "id="+id,
              dataType:'json',
              success: function (response) {
                  if (response.error == 200) {
                      showSucc(response.msg);
                      setTimeout("load()", 1000);
                  } else {
                      throwExc(response.msg);
                      return false;
                  }
              }
          });
      });
      //重刷页面
      function load(){
          var page = $("#pageCurrentNum").val();
          if(page){
               window.location.href="?c=withdraw&a=lst&p="+page;
          }else{
               window.location.href="?c=withdraw&a=lst"; 
          }
         
      };
  </script>